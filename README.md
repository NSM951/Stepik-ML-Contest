# Stepik-ML-Contest
Репозиторий по Stepik ML Contest в рамках курса [Введение в Data Science и машинное обучение](https://stepik.org/course/4852).

# Описание проекта
Практический проект курса [Введение в Data Science и машинное обучение](https://stepik.org/course/4852).
Проект заключается в анализе активности студентов онлайн курса Введение в анализ данных в R.

Задача состояла в том, чтобы на основе данных о действиях пользователей за первые два дня с начала курса, построить модель
рассчитывающую вероятность того, что пользователь окончит курс.

**Описание решения задачи**
На основании данных из *events_train.csv* и *submissions_train.csv* были определенны пользователи, которые окончили курс (при наборе 170 баллов),
а также пользователи бросившие курс (в течении 30 дней не совершали действий на курсе). Считалось, что пользователи не удовлетворяющие обоим этим условиям, проходят курс в настоящий момент.
Под настоящим моментом подразумевается следующая дата: 19.05.2018. Данные пользователей окончивших и бросивших курс были ограничены двумя днями.<br>

По этим данным было обучено три классифицирующие модели DecisionTreeСlassifier, LogisticRegression и RandomForestTree. Для каждой модели производился подбор параметров с помощью GridSearchCV.
Для RandomForestTree использовался RandomizedSearchCV с целью экономии времени. Метрикой оценивания моделей являлся roc_auc_score(требование задачи).<br>

Данные из файлов *events_train.csv* и *submissions_train.csv* были поделены на train и test датасеты. test датасет использовался для определения roc_auc_score моделей.
Наибольшие значения roc_auc_score были получены у DecisionTreeСlassifier и RandomForestTree. В качестве рабочей модели была выбрана модель RandomForestTree, так как она менее склонна к переобучению.
Эта модель была сохранена в файл *trained_model.pkl* и затем использовалась для расчета вероятности того, что пользователь окончит курс.<br>

Затем на основании данных из *events_test.csv* и *submissions_test.csv* был сформирован датасет с такой же структурой как и обучающий датасет и с помощью модели рассчитывалась вероятность того, что пользователь окончит курс.
Эти данные сохранялись в файле *out_1.csv* и сабмитились на степике. ROC score составил 0.8866922822045981.

**Описание загруженных файлов**<br>
*1.ipynb* - черновой notebook который использовался в течении курса для освоения материала курса на примере итогового проекта. Содержит в себе обработку обучающих данных с помощью pandas, а также обучение первых моделей.<br>

*train.ipynb* - чистовой notebook на основе *1.ipynb* используется для формирования датасета и обучения модели.<br>

*trained_model.pkl* - обученная модель сохранялась в этот .pkl файл.<br>

*train.ipynb* - чистовой notebook, в котором формировался датасет для расчета вероятности того, что пользователь окончит курс. <br>

*events_train.csv* и *submissions_train.csv* - данные, которые использовались для формирования обучающего датасета.<br>

*events_test.csv* и *submissions_test.csv* - данные, которые использовались для формирования тестируемого датасета.<br>

*out_1.csv* - результат работы модели на тестовых данных.<br>

**Необходимые внешние библиотеки**
* [pandas](https://pandas.pydata.org/)
* [numpy](https://numpy.org/)
* [matplotlib](https://matplotlib.org/)
* [seaborn](https://seaborn.pydata.org/)
* [sklearn](https://scikit-learn.org/stable/)


# Описание данных:

* **events_train.csv** - данные о действиях, которые совершают студенты со стэпами

  * step_id - id стэпа
  * user_id - анонимизированный id юзера
  * timestamp - время наступления события в формате unix date
  * action - событие, возможные значения: 
  * discovered - пользователь перешел на стэп
  * viewed - просмотр шага,
  * started_attempt - начало попытки решить шаг, ранее нужно было явно нажать на кнопку - начать решение, перед тем как приступить к решению практического шага
  * passed - удачное решение практического шага

* **submissions_train.csv** - данные о времени и статусах сабмитов к практическим заданиям

  * step_id - id стэпа
  * timestamp - время отправки решения в формате unix date
  * submission_status - статус решения
  * user_id - анонимизированный id юзера
 
# P.S. 
Это мой первый полноценный репозиторий на GitHub. Поэтому оформление проекта желает оставлять лучшего. По мере возможностей проект будет модернизироваться.<br>
**P.P.S.** 
***<ins>Сhange by design - or/not by disaster.</ins>***

  
